(this["webpackJsonpjest-subtlecrypto-test"]=this["webpackJsonpjest-subtlecrypto-test"]||[]).push([[0],{196:function(e,t,n){},197:function(e,t,n){},434:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(28),c=n.n(s),o=n(103),i=n.n(o),h=n(104),p=n.n(h),l=n(79),j=n.n(l),b=n(8),u=n(7),d=n(9),y=n(10),O=(n(196),n(197),n(4)),g=n(5),m=n(12);function x(){return(x=Object(m.a)(Object(g.a)().mark((function e(){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["encrypt","decrypt"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=n(17),f=n.n(v),w=n(448),K=n(0),k=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(O.a)(r)),r}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=this;e.preventDefault(),function(){return x.apply(this,arguments)}().then((function(e){console.log("### RootRSAOAEPKey ###"),console.log("key.publicKey",e.publicKey),console.log("key.privateKey",e.privateKey),t.props.onGenerateKey(e)}))}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",{children:Object(K.jsx)(f.a,{onClick:this.handleChange,label:"Generate Root RSA-OAEPKey"})}),Object(K.jsx)("div",{children:Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Open your console to see the generated root CryptoKey"})})]})}}]),n}(a.a.Component),P=k,A=n(449),C=n(44),E=n.n(C),S=n(451),R=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleRootRSAOAEPKeyChange=r.handleRootRSAOAEPKeyChange.bind(Object(O.a)(r)),r.handleExportKeys=r.handleExportKeys.bind(Object(O.a)(r)),r.handleImportKeys=r.handleImportKeys.bind(Object(O.a)(r)),r.handleEncryptMessage=r.handleEncryptMessage.bind(Object(O.a)(r)),r.handleMessageToEncryptChange=r.handleMessageToEncryptChange.bind(Object(O.a)(r)),r.handleDecryptMessage=r.handleDecryptMessage.bind(Object(O.a)(r)),r.state={RootRSAOAEPKey:{},jwkPublicKey:"",jwkPrivateKey:"",isRootRSAOAEPKeySet:!1,importedPublicKey:"",importedPrivateKey:"",encryptedMessage:"",messageToEncrypt:"Hello World! 12345",decryptedMessage:""},r}return Object(u.a)(n,[{key:"handleRootRSAOAEPKeyChange",value:function(e){this.setState({RootRSAOAEPKey:e,isRootRSAOAEPKeySet:!0})}},{key:"handleExportKeys",value:function(e,t){this.setState({jwkPublicKey:e,jwkPrivateKey:t})}},{key:"handleImportKeys",value:function(e,t){this.setState({importedPublicKey:e,importedPrivateKey:t})}},{key:"handleEncryptMessage",value:function(e){this.setState({encryptedMessage:e})}},{key:"handleMessageToEncryptChange",value:function(e){this.setState({messageToEncrypt:e})}},{key:"handleDecryptMessage",value:function(e){this.setState({decryptedMessage:e})}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)("section",{children:[Object(K.jsx)(w.a,{component:"p",gutterBottom:!0,children:"Hello and welcome! My aim here is to try and give a clear example of how we can use WebCrypto in a simple use case and hopefully give you an idea of how you can use it, test it and implement it into your own projects."}),Object(K.jsx)(w.a,{component:"p",gutterBottom:!0,children:"I will try and give an example User Story that will give us an overview of what we need to achieve and then step by step how we achieve this."}),Object(K.jsx)(w.a,{component:"p",gutterBottom:!0,children:"Each step will include a link to the react component, encryption library component needed and a code example"}),Object(K.jsx)(w.a,{component:"p",gutterBottom:!0,children:"All the following methods are wrapped in tests. I would highly recommend reading through the test cases as they can be a great insight on how the code fits together."})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(w.a,{variant:"h3",component:"h3",gutterBottom:!0,children:"User Stories"}),Object(K.jsx)(w.a,{component:"p",gutterBottom:!0,children:Object(K.jsxs)("ol",{children:[Object(K.jsx)("li",{children:"A user should be able to generate a new, unique encryption key"}),Object(K.jsx)("li",{children:"They will be able to export the private and public keys in a format that can be saved"}),Object(K.jsx)("li",{children:"They will be able to re-import these keys to use"}),Object(K.jsx)("li",{children:"They will be able to encrypt a message using their public key"}),Object(K.jsx)("li",{children:"They will be able to decrypt their message using their private key"})]})}),Object(K.jsx)(A.a,{variant:"middle"})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(w.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Step 1: Root Certificate (RSA-OAEP)"}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsx)("strong",{children:"User Story:"})," A user should be able to generate a new, unique encryption key"]}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/components/RootRSAOAEPKey.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"React Component"]}),Object(K.jsx)("br",{}),Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/lib/RootRSAOAEPKey.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"Lib"]})]}),Object(K.jsx)(E.a,{language:"javascript",children:"\n  export async function generateKey () {\n    return window.crypto.subtle.generateKey({\n      name: 'RSA-OAEP',\n      modulusLength: 2048,\n      publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n      hash: {\n        name: 'SHA-256'\n      }\n    },\n    true,\n    ['encrypt', 'decrypt']\n    )\n  }\n            "}),Object(K.jsx)(P,{onGenerateKey:this.handleRootRSAOAEPKeyChange}),Object(K.jsxs)(w.a,{variant:"body1",gutterBottom:!0,children:["Root Key Set: ",this.state.isRootRSAOAEPKeySet.toString()]})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(A.a,{variant:"middle"}),Object(K.jsx)(w.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Step 2: Export Keys"}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsx)("strong",{children:"User Story:"})," They will be able to export the private and public keys in a format that can be saved"]}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/components/ExportKeys.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"React Component"]}),Object(K.jsx)("br",{}),Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/lib/exportKeys.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"Lib"]})]}),Object(K.jsx)(E.a,{language:"javascript",children:"\n  async function exportKey (keyData) {\n    return window.crypto.subtle.exportKey('jwk', keyData)\n      .then((key) => {\n        return (key)\n      })\n  }\n  \n  export async function exportjwkPublicKey (key) {\n    return exportKey(key.publicKey)\n  }\n  \n  export async function exportjwkPrivateKey (key) {\n    return exportKey(key.privateKey)\n  }  \n            "}),Object(K.jsx)(H,{onExportKeys:this.handleExportKeys,rootKey:this.state.RootRSAOAEPKey,jwkPublicKey:this.state.jwkPublicKey,jwkPrivateKey:this.state.jwkPrivateKey,isRootKeySet:this.state.isRootRSAOAEPKeySet})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(A.a,{variant:"middle"}),Object(K.jsx)(w.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Step 3: Import Key"}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsx)("strong",{children:"User Story:"})," They will be able to re-import these keys to use"]}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/components/ImportKeys.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"React Component"]}),Object(K.jsx)("br",{}),Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/lib/importKeys.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"Lib"]})]}),Object(K.jsx)(E.a,{language:"javascript",children:"\n  export async function importPublicFromJwk (keyData) {\n    return window.crypto.subtle.importKey(\n      'jwk',\n      keyData,\n      {\n        name: 'RSA-OAEP',\n        hash: 'SHA-256'\n      },\n      true,\n      ['encrypt']\n    )\n  }\n  \n  export async function importPrivateFromJwk (keyData) {\n    return window.crypto.subtle.importKey(\n      'jwk',\n      keyData,\n      {\n        name: 'RSA-OAEP',\n        hash: 'SHA-256'\n      },\n      true,\n      ['decrypt']\n    )\n  }  \n            "}),Object(K.jsx)(W,{onImportKeys:this.handleImportKeys,jwkPublicKey:this.state.jwkPublicKey,jwkPrivateKey:this.state.jwkPrivateKey,importedPublicKey:this.state.importedPublicKey,importedPrivateKey:this.state.importedPrivateKey})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(A.a,{variant:"middle"}),Object(K.jsx)(w.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Step 4: SHA Encrypt Object"}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsx)("strong",{children:"User Story:"})," They will be able to encrypt a message using their public key"]}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/components/EncryptMessage.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"React Component"]}),Object(K.jsx)("br",{}),Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/lib/encryptMessage.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"Lib"]})]}),Object(K.jsx)(E.a,{language:"javascript",children:"\n  export async function encryptMessage (publicKey, encodedMessage) {\n    return window.crypto.subtle.encrypt(\n      {\n        name: 'RSA-OAEP'\n      },\n      publicKey,\n      encodedMessage\n    )\n  }  \n            "}),Object(K.jsx)(q,{onEncryptMessage:this.handleEncryptMessage,onMessageToEncryptChange:this.handleMessageToEncryptChange,importedPublicKey:this.state.importedPublicKey,messageToEncrypt:this.state.messageToEncrypt,encryptedMessage:this.state.encryptedMessage})]}),Object(K.jsxs)("section",{children:[Object(K.jsx)(A.a,{variant:"middle"}),Object(K.jsx)(w.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Step 5: SHA Decrypt"}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsx)("strong",{children:"User Story:"})," They will be able to decrypt their message using their private key"]}),Object(K.jsxs)(w.a,{component:"p",gutterBottom:!0,children:[Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/components/DecryptMessage.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"React Component"]}),Object(K.jsx)("br",{}),Object(K.jsxs)(S.a,{href:"https://github.com/johnnolan/react-jest-webcrypto/blob/master/src/lib/decryptMessage.js",children:[Object(K.jsx)("strong",{children:"Code: "}),"Lib"]})]}),Object(K.jsx)(E.a,{language:"javascript",children:"\n  export async function decryptMessage (publicKey, ciphertext) {\n    return window.crypto.subtle.decrypt(\n      {\n        name: 'RSA-OAEP'\n      },\n      publicKey,\n      ciphertext\n    )\n  }  \n            "}),Object(K.jsx)(z,{onDecryptMessage:this.handleDecryptMessage,importedPrivateKey:this.state.importedPrivateKey,encryptedMessage:this.state.encryptedMessage,decryptedMessage:this.state.decryptedMessage})]})]})}}]),n}(a.a.Component);function M(e){return B.apply(this,arguments)}function B(){return(B=Object(m.a)(Object(g.a)().mark((function e(t){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.exportKey("jwk",t).then((function(e){return e})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(m.a)(Object(g.a)().mark((function e(t){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(t.publicKey));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(m.a)(Object(g.a)().mark((function e(t){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(t.privateKey));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(O.a)(r)),r}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=this;e.preventDefault();var n=this.props.rootKey;(function(e){return T.apply(this,arguments)})(n).then((function(e){(function(e){return D.apply(this,arguments)})(n).then((function(n){t.props.onExportKeys(e,n)}))}))}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",{children:Object(K.jsx)(f.a,{disabled:!this.props.isRootKeySet,onClick:this.handleChange,label:"Export Root RSA-OAEPKeys"})}),Object(K.jsxs)("div",{children:[Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Exported JWK Public Key"}),Object(K.jsx)("textarea",{rows:"6",cols:"100",readOnly:!0,value:JSON.stringify(this.props.jwkPublicKey)})]}),Object(K.jsxs)("div",{children:[Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Exported JWK Private Key"}),Object(K.jsx)("textarea",{rows:"6",cols:"100",readOnly:!0,value:JSON.stringify(this.props.jwkPrivateKey)})]})]})}}]),n}(a.a.Component),H=I;function U(){return(U=Object(m.a)(Object(g.a)().mark((function e(t){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("jwk",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(m.a)(Object(g.a)().mark((function e(t){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("jwk",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(O.a)(r)),r}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=this;e.preventDefault();var n=this.props.jwkPublicKey,r=this.props.jwkPrivateKey;(function(e){return U.apply(this,arguments)})(n).then((function(e){(function(e){return F.apply(this,arguments)})(r).then((function(n){console.log("### Imported Keys ###"),console.log("importedPublicKey",e),console.log("importedPrivateKey",n),t.props.onImportKeys(e,n)}))}))}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",{children:Object(K.jsx)(f.a,{onClick:this.handleChange,label:"Import Public and Private Key (Check console for CryptoKey)",disabled:""===this.props.jwkPublicKey})}),Object(K.jsx)("div",{children:Object(K.jsxs)(w.a,{variant:"body1",gutterBottom:!0,children:["Imported Public Key: ",(""!==this.props.importedPublicKey).toString()]})}),Object(K.jsx)("div",{children:Object(K.jsxs)(w.a,{variant:"body1",gutterBottom:!0,children:["Imported Private Key: ",(""!==this.props.importedPrivateKey).toString()]})})]})}}]),n}(a.a.Component),W=J;function L(){return(L=Object(m.a)(Object(g.a)().mark((function e(t,n){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.encrypt({name:"RSA-OAEP"},t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(O.a)(r)),r.handleMessageChange=r.handleMessageChange.bind(Object(O.a)(r)),r}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=this;e.preventDefault(),function(e,t){return L.apply(this,arguments)}(this.props.importedPublicKey,(new TextEncoder).encode(this.props.messageToEncrypt)).then((function(e){t.props.onEncryptMessage(e)}))}},{key:"handleMessageChange",value:function(e){this.props.onMessageToEncryptChange(e.target.value)}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",{children:Object(K.jsx)(f.a,{disabled:""===this.props.importedPublicKey,onClick:this.handleChange,label:"Encrypt Message"})}),Object(K.jsxs)("div",{children:[Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Message to Encrypt"}),Object(K.jsx)("textarea",{rows:"6",cols:"100",value:this.props.messageToEncrypt,onChange:this.handleMessageChange})]}),Object(K.jsxs)("div",{children:[Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Encrypted Message (ArrayBuffer to Hex for demo)"}),Object(K.jsx)("textarea",{rows:"6",cols:"100",readOnly:!0,value:(e=this.props.encryptedMessage,Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)})).join(""))})]})]});var e}}]),n}(a.a.Component),q=G;function N(){return(N=Object(m.a)(Object(g.a)().mark((function e(t,n){return Object(g.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.decrypt({name:"RSA-OAEP"},t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(O.a)(r)),r}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=this;e.preventDefault(),function(e,t){return N.apply(this,arguments)}(this.props.importedPrivateKey,this.props.encryptedMessage).then((function(e){t.props.onDecryptMessage((new TextDecoder).decode(e))}))}},{key:"render",value:function(){return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("div",{children:Object(K.jsx)(f.a,{disabled:""===this.props.importedPrivateKey||""===this.props.encryptedMessage,onClick:this.handleChange,label:"Decrypt Message"})}),Object(K.jsxs)("div",{children:[Object(K.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Decrypted Message"}),Object(K.jsx)("textarea",{rows:"6",cols:"100",readOnly:!0,value:this.props.decryptedMessage})]})]})}}]),n}(a.a.Component),z=$,Q=n(450),V=function(e){Object(d.a)(n,e);var t=Object(y.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(Q.a,{maxWidth:"sm",children:[Object(K.jsx)(w.a,{variant:"h1",component:"h1",gutterBottom:!0,children:"Test WebCrypto"}),Object(K.jsx)(R,{})]})}}]),n}(r.Component),X=V;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=function(){return Object(K.jsx)(p.a,{muiTheme:j()(i.a),children:Object(K.jsx)(X,{})})};c.a.render(Object(K.jsx)(Y,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[434,1,2]]]);
//# sourceMappingURL=main.4b22d028.chunk.js.map